<html>
<head>
<title>test_vector_type.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #5f826b; font-style: italic;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #2aacb8;}
.s5 { color: #6aab73;}
.s6 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_vector_type.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot; 
CUDA vector type tests. Note that this test file imports 
`cuda.vector_type` module to programmatically test all the 
vector types. However, `vector_type` module is internal 
and should not be imported by user, user should only import the 
corresponding vector type from `cuda` module in kernel to use them. 
&quot;&quot;&quot;</span>

<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>

<span class="s2">from </span><span class="s1">numba</span><span class="s3">.</span><span class="s1">core </span><span class="s2">import </span><span class="s1">config</span>
<span class="s2">from </span><span class="s1">numba</span><span class="s3">.</span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">testing </span><span class="s2">import </span><span class="s1">CUDATestCase</span>

<span class="s2">from </span><span class="s1">numba </span><span class="s2">import </span><span class="s1">cuda</span>

<span class="s2">if </span><span class="s1">config</span><span class="s3">.</span><span class="s1">ENABLE_CUDASIM</span><span class="s3">:</span>
    <span class="s2">from </span><span class="s1">numba</span><span class="s3">.</span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">simulator</span><span class="s3">.</span><span class="s1">vector_types </span><span class="s2">import </span><span class="s1">vector_types</span>
<span class="s2">else</span><span class="s3">:</span>
    <span class="s2">from </span><span class="s1">numba</span><span class="s3">.</span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">vector_types </span><span class="s2">import </span><span class="s1">vector_types</span>


<span class="s2">def </span><span class="s1">make_kernel</span><span class="s3">(</span><span class="s1">vtype</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Returns a jit compiled kernel that constructs a vector types of 
    the given type, using the exact number of primitive types to 
    construct the vector type. 
    &quot;&quot;&quot;</span>
    <span class="s1">vobj </span><span class="s3">= </span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">user_facing_object</span>
    <span class="s1">base_type </span><span class="s3">= </span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">base_type</span>

    <span class="s2">def </span><span class="s1">kernel_1elem</span><span class="s3">(</span><span class="s1">res</span><span class="s3">):</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">vobj</span><span class="s3">(</span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">0</span><span class="s3">))</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>

    <span class="s2">def </span><span class="s1">kernel_2elem</span><span class="s3">(</span><span class="s1">res</span><span class="s3">):</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">vobj</span><span class="s3">(</span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">0</span><span class="s3">), </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">1</span><span class="s3">))</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>

    <span class="s2">def </span><span class="s1">kernel_3elem</span><span class="s3">(</span><span class="s1">res</span><span class="s3">):</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">vobj</span><span class="s3">(</span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">0</span><span class="s3">), </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">1</span><span class="s3">), </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">2</span><span class="s3">))</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">2</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">z</span>

    <span class="s2">def </span><span class="s1">kernel_4elem</span><span class="s3">(</span><span class="s1">res</span><span class="s3">):</span>
        <span class="s1">v </span><span class="s3">= </span><span class="s1">vobj</span><span class="s3">(</span>
            <span class="s1">base_type</span><span class="s3">(</span><span class="s4">0</span><span class="s3">),</span>
            <span class="s1">base_type</span><span class="s3">(</span><span class="s4">1</span><span class="s3">),</span>
            <span class="s1">base_type</span><span class="s3">(</span><span class="s4">2</span><span class="s3">),</span>
            <span class="s1">base_type</span><span class="s3">(</span><span class="s4">3</span><span class="s3">)</span>
        <span class="s3">)</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">2</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">z</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">3</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">w</span>

    <span class="s1">host_function </span><span class="s3">= {</span>
        <span class="s4">1</span><span class="s3">: </span><span class="s1">kernel_1elem</span><span class="s3">,</span>
        <span class="s4">2</span><span class="s3">: </span><span class="s1">kernel_2elem</span><span class="s3">,</span>
        <span class="s4">3</span><span class="s3">: </span><span class="s1">kernel_3elem</span><span class="s3">,</span>
        <span class="s4">4</span><span class="s3">: </span><span class="s1">kernel_4elem</span>
    <span class="s3">}[</span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">num_elements</span><span class="s3">]</span>
    <span class="s2">return </span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">jit</span><span class="s3">(</span><span class="s1">host_function</span><span class="s3">)</span>


<span class="s2">def </span><span class="s1">make_fancy_creation_kernel</span><span class="s3">(</span><span class="s1">vtype</span><span class="s3">):</span>
    <span class="s0">&quot;&quot;&quot; 
    Returns a jit compiled kernel that constructs a vector type using the 
    &quot;fancy&quot; construction, that is, with arbitrary combinations of primitive 
    types and vector types, as long as the total element of the construction 
    is the same as the number of elements of the vector type. 
    &quot;&quot;&quot;</span>
    <span class="s1">base_type </span><span class="s3">= </span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">base_type</span>
    <span class="s1">v1 </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">name</span><span class="s3">[:-</span><span class="s4">1</span><span class="s3">]</span><span class="s2">}</span><span class="s5">1&quot;</span><span class="s3">)</span>
    <span class="s1">v2 </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">name</span><span class="s3">[:-</span><span class="s4">1</span><span class="s3">]</span><span class="s2">}</span><span class="s5">2&quot;</span><span class="s3">)</span>
    <span class="s1">v3 </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">name</span><span class="s3">[:-</span><span class="s4">1</span><span class="s3">]</span><span class="s2">}</span><span class="s5">3&quot;</span><span class="s3">)</span>
    <span class="s1">v4 </span><span class="s3">= </span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s5">f&quot;</span><span class="s2">{</span><span class="s1">vtype</span><span class="s3">.</span><span class="s1">name</span><span class="s3">[:-</span><span class="s4">1</span><span class="s3">]</span><span class="s2">}</span><span class="s5">4&quot;</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">kernel</span><span class="s3">(</span><span class="s1">res</span><span class="s3">):</span>
        <span class="s1">one </span><span class="s3">= </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">1.0</span><span class="s3">)</span>
        <span class="s1">two </span><span class="s3">= </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">2.0</span><span class="s3">)</span>
        <span class="s1">three </span><span class="s3">= </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">3.0</span><span class="s3">)</span>
        <span class="s1">four </span><span class="s3">= </span><span class="s1">base_type</span><span class="s3">(</span><span class="s4">4.0</span><span class="s3">)</span>

        <span class="s1">j </span><span class="s3">= </span><span class="s4">0   </span><span class="s6"># index of the result array</span>

        <span class="s6"># Construct a 1-component vector type, possible combination includes:</span>
        <span class="s6"># 2C1 = 2 combinations.</span>

        <span class="s1">f1_1 </span><span class="s3">= </span><span class="s1">v1</span><span class="s3">(</span><span class="s1">one</span><span class="s3">)  </span><span class="s6"># 1</span>
        <span class="s1">f1_2 </span><span class="s3">= </span><span class="s1">v1</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">) </span><span class="s6"># 1</span>

        <span class="s1">res</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">f1_1</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">res</span><span class="s3">[</span><span class="s4">1</span><span class="s3">] = </span><span class="s1">f1_2</span><span class="s3">.</span><span class="s1">x</span>
        <span class="s1">j </span><span class="s3">+= </span><span class="s4">2</span>

        <span class="s6"># Construct a 2-component vector type, possible combination includes:</span>
        <span class="s6"># 1 + 2C1 * 2 = 5 combinations</span>

        <span class="s1">f2_1 </span><span class="s3">= </span><span class="s1">v2</span><span class="s3">(</span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)       </span><span class="s6"># 2 3</span>
        <span class="s1">f2_2 </span><span class="s3">= </span><span class="s1">v2</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)      </span><span class="s6"># 1 3</span>
        <span class="s1">f2_3 </span><span class="s3">= </span><span class="s1">v2</span><span class="s3">(</span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)        </span><span class="s6"># 2 1</span>
        <span class="s1">f2_4 </span><span class="s3">= </span><span class="s1">v2</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)       </span><span class="s6"># 1 1</span>
        <span class="s1">f2_5 </span><span class="s3">= </span><span class="s1">v2</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">)             </span><span class="s6"># 2 3</span>

        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f2_2</span><span class="s3">, </span><span class="s1">f2_3</span><span class="s3">, </span><span class="s1">f2_4</span><span class="s3">, </span><span class="s1">f2_5</span><span class="s3">):</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>
            <span class="s1">j </span><span class="s3">+= </span><span class="s4">2</span>

        <span class="s6"># Construct a 3-component vector type, possible combination includes:</span>
        <span class="s6"># 1 + 2C1 * 2 + 2^3 = 13 combinations</span>

        <span class="s1">f3_1 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">one</span><span class="s3">)            </span><span class="s6"># 2 3 1</span>
        <span class="s1">f3_2 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)           </span><span class="s6"># 2 3 1</span>
        <span class="s1">f3_3 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)            </span><span class="s6"># 1 2 3</span>
        <span class="s1">f3_4 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)           </span><span class="s6"># 1 2 3</span>

        <span class="s1">f3_5 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)      </span><span class="s6"># 1 2 3</span>
        <span class="s1">f3_6 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)     </span><span class="s6"># 1 2 3</span>
        <span class="s1">f3_7 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)     </span><span class="s6"># 1 1 3</span>
        <span class="s1">f3_8 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)       </span><span class="s6"># 1 2 1</span>
        <span class="s1">f3_9 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)    </span><span class="s6"># 1 1 3</span>
        <span class="s1">f3_10 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)     </span><span class="s6"># 1 1 1</span>
        <span class="s1">f3_11 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)     </span><span class="s6"># 1 2 1</span>
        <span class="s1">f3_12 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)    </span><span class="s6"># 1 1 1</span>

        <span class="s1">f3_13 </span><span class="s3">= </span><span class="s1">v3</span><span class="s3">(</span><span class="s1">f3_1</span><span class="s3">)                </span><span class="s6"># 2 3 1</span>

        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s3">(</span><span class="s1">f3_1</span><span class="s3">, </span><span class="s1">f3_2</span><span class="s3">, </span><span class="s1">f3_3</span><span class="s3">, </span><span class="s1">f3_4</span><span class="s3">, </span><span class="s1">f3_5</span><span class="s3">, </span><span class="s1">f3_6</span><span class="s3">, </span><span class="s1">f3_7</span><span class="s3">, </span><span class="s1">f3_8</span><span class="s3">, </span><span class="s1">f3_9</span><span class="s3">,</span>
                  <span class="s1">f3_10</span><span class="s3">, </span><span class="s1">f3_11</span><span class="s3">, </span><span class="s1">f3_12</span><span class="s3">, </span><span class="s1">f3_13</span><span class="s3">):</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">2</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">z</span>
            <span class="s1">j </span><span class="s3">+= </span><span class="s4">3</span>

        <span class="s6"># Construct a 4-component vector type, possible combination includes:</span>
        <span class="s6"># 1 + (2C1 * 2 + 1) + 3C1 * 2^2 + 2^4 = 34 combinations</span>

        <span class="s1">f4_1 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)    </span><span class="s6"># 1 2 3 4</span>
        <span class="s1">f4_2 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)   </span><span class="s6"># 1 2 3 4</span>
        <span class="s1">f4_3 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)   </span><span class="s6"># 1 1 3 4</span>
        <span class="s1">f4_4 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)     </span><span class="s6"># 1 2 1 4</span>
        <span class="s1">f4_5 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)    </span><span class="s6"># 1 2 3 1</span>
        <span class="s1">f4_6 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)  </span><span class="s6"># 1 1 3 4</span>
        <span class="s1">f4_7 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)    </span><span class="s6"># 1 2 1 4</span>
        <span class="s1">f4_8 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)   </span><span class="s6"># 1 2 3 1</span>
        <span class="s1">f4_9 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)    </span><span class="s6"># 1 1 1 4</span>
        <span class="s1">f4_10 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)  </span><span class="s6"># 1 1 3 1</span>
        <span class="s1">f4_11 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)    </span><span class="s6"># 1 2 1 1</span>
        <span class="s1">f4_12 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)  </span><span class="s6"># 1 1 1 4</span>
        <span class="s1">f4_13 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">) </span><span class="s6"># 1 1 3 1</span>
        <span class="s1">f4_14 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)   </span><span class="s6"># 1 2 1 1</span>
        <span class="s1">f4_15 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)   </span><span class="s6"># 1 1 1 1</span>
        <span class="s1">f4_16 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)  </span><span class="s6"># 1 1 1 1</span>

        <span class="s1">f4_17 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)        </span><span class="s6"># 2 3 2 3</span>
        <span class="s1">f4_18 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)       </span><span class="s6"># 2 3 1 3</span>
        <span class="s1">f4_19 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">two</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)         </span><span class="s6"># 2 3 2 1</span>
        <span class="s1">f4_20 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)        </span><span class="s6"># 2 3 1 1</span>
        <span class="s1">f4_21 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)        </span><span class="s6"># 1 2 3 3</span>
        <span class="s1">f4_22 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">three</span><span class="s3">)       </span><span class="s6"># 1 2 3 3</span>
        <span class="s1">f4_23 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)         </span><span class="s6"># 1 2 3 1</span>
        <span class="s1">f4_24 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)        </span><span class="s6"># 1 2 3 1</span>
        <span class="s1">f4_25 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">four</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)         </span><span class="s6"># 1 4 2 3</span>
        <span class="s1">f4_26 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)        </span><span class="s6"># 1 4 2 3</span>
        <span class="s1">f4_27 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">one</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)         </span><span class="s6"># 1 1 2 3</span>
        <span class="s1">f4_28 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)        </span><span class="s6"># 1 1 2 3</span>

        <span class="s1">f4_29 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f2_1</span><span class="s3">, </span><span class="s1">f2_1</span><span class="s3">)              </span><span class="s6"># 2 3 2 3</span>
        <span class="s1">f4_30 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f3_1</span><span class="s3">, </span><span class="s1">four</span><span class="s3">)              </span><span class="s6"># 2 3 1 4</span>
        <span class="s1">f4_31 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f3_1</span><span class="s3">, </span><span class="s1">f1_1</span><span class="s3">)              </span><span class="s6"># 2 3 1 1</span>
        <span class="s1">f4_32 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">four</span><span class="s3">, </span><span class="s1">f3_1</span><span class="s3">)              </span><span class="s6"># 4 2 3 1</span>
        <span class="s1">f4_33 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f1_1</span><span class="s3">, </span><span class="s1">f3_1</span><span class="s3">)              </span><span class="s6"># 1 2 3 1</span>

        <span class="s1">f4_34 </span><span class="s3">= </span><span class="s1">v4</span><span class="s3">(</span><span class="s1">f4_1</span><span class="s3">)                    </span><span class="s6"># 1 2 3 4</span>

        <span class="s2">for </span><span class="s1">v </span><span class="s2">in </span><span class="s3">(</span><span class="s1">f4_1</span><span class="s3">, </span><span class="s1">f4_2</span><span class="s3">, </span><span class="s1">f4_3</span><span class="s3">, </span><span class="s1">f4_4</span><span class="s3">, </span><span class="s1">f4_5</span><span class="s3">, </span><span class="s1">f4_6</span><span class="s3">, </span><span class="s1">f4_7</span><span class="s3">, </span><span class="s1">f4_8</span><span class="s3">, </span><span class="s1">f4_9</span><span class="s3">, </span><span class="s1">f4_10</span><span class="s3">,</span>
                  <span class="s1">f4_11</span><span class="s3">, </span><span class="s1">f4_12</span><span class="s3">, </span><span class="s1">f4_13</span><span class="s3">, </span><span class="s1">f4_14</span><span class="s3">, </span><span class="s1">f4_15</span><span class="s3">, </span><span class="s1">f4_16</span><span class="s3">, </span><span class="s1">f4_17</span><span class="s3">, </span><span class="s1">f4_18</span><span class="s3">, </span><span class="s1">f4_19</span><span class="s3">,</span>
                  <span class="s1">f4_20</span><span class="s3">, </span><span class="s1">f4_21</span><span class="s3">, </span><span class="s1">f4_22</span><span class="s3">, </span><span class="s1">f4_23</span><span class="s3">, </span><span class="s1">f4_24</span><span class="s3">, </span><span class="s1">f4_25</span><span class="s3">, </span><span class="s1">f4_26</span><span class="s3">, </span><span class="s1">f4_27</span><span class="s3">, </span><span class="s1">f4_28</span><span class="s3">,</span>
                  <span class="s1">f4_29</span><span class="s3">, </span><span class="s1">f4_30</span><span class="s3">, </span><span class="s1">f4_31</span><span class="s3">, </span><span class="s1">f4_32</span><span class="s3">, </span><span class="s1">f4_33</span><span class="s3">, </span><span class="s1">f4_34</span><span class="s3">):</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">x</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">y</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">2</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">z</span>
            <span class="s1">res</span><span class="s3">[</span><span class="s1">j </span><span class="s3">+ </span><span class="s4">3</span><span class="s3">] = </span><span class="s1">v</span><span class="s3">.</span><span class="s1">w</span>
            <span class="s1">j </span><span class="s3">+= </span><span class="s4">4</span>

    <span class="s2">return </span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">jit</span><span class="s3">(</span><span class="s1">kernel</span><span class="s3">)</span>


<span class="s2">class </span><span class="s1">TestCudaVectorType</span><span class="s3">(</span><span class="s1">CUDATestCase</span><span class="s3">):</span>

    <span class="s2">def </span><span class="s1">test_basic</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0">&quot;&quot;&quot;Basic test that makes sure that vector type and aliases 
        are available within the cuda module from both device and 
        simulator mode. This is an important sanity check, since other 
        tests below tests the vector type objects programmatically. 
        &quot;&quot;&quot;</span>
        <span class="s3">@</span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">jit</span><span class="s3">(</span><span class="s5">&quot;void(float64[:])&quot;</span><span class="s3">)</span>
        <span class="s2">def </span><span class="s1">kernel</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">):</span>
            <span class="s1">v1 </span><span class="s3">= </span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">float64x4</span><span class="s3">(</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">5.0</span><span class="s3">, </span><span class="s4">7.0</span><span class="s3">)</span>
            <span class="s1">v2 </span><span class="s3">= </span><span class="s1">cuda</span><span class="s3">.</span><span class="s1">short2</span><span class="s3">(</span><span class="s4">10</span><span class="s3">, </span><span class="s4">11</span><span class="s3">)</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">0</span><span class="s3">] = </span><span class="s1">v1</span><span class="s3">.</span><span class="s1">x</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">1</span><span class="s3">] = </span><span class="s1">v1</span><span class="s3">.</span><span class="s1">y</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">2</span><span class="s3">] = </span><span class="s1">v1</span><span class="s3">.</span><span class="s1">z</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">3</span><span class="s3">] = </span><span class="s1">v1</span><span class="s3">.</span><span class="s1">w</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">4</span><span class="s3">] = </span><span class="s1">v2</span><span class="s3">.</span><span class="s1">x</span>
            <span class="s1">arr</span><span class="s3">[</span><span class="s4">5</span><span class="s3">] = </span><span class="s1">v2</span><span class="s3">.</span><span class="s1">y</span>

        <span class="s1">res </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">(</span><span class="s4">6</span><span class="s3">, </span><span class="s1">dtype</span><span class="s3">=</span><span class="s1">np</span><span class="s3">.</span><span class="s1">float64</span><span class="s3">)</span>
        <span class="s1">kernel</span><span class="s3">[</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">](</span><span class="s1">res</span><span class="s3">)</span>
        <span class="s1">self</span><span class="s3">.</span><span class="s1">assertTrue</span><span class="s3">(</span><span class="s1">np</span><span class="s3">.</span><span class="s1">allclose</span><span class="s3">(</span><span class="s1">res</span><span class="s3">, [</span><span class="s4">1.0</span><span class="s3">, </span><span class="s4">3.0</span><span class="s3">, </span><span class="s4">5.0</span><span class="s3">, </span><span class="s4">7.0</span><span class="s3">, </span><span class="s4">10</span><span class="s3">, </span><span class="s4">11</span><span class="s3">]))</span>

    <span class="s2">def </span><span class="s1">test_creation_readout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">vty </span><span class="s2">in </span><span class="s1">vector_types</span><span class="s3">.</span><span class="s1">values</span><span class="s3">():</span>
            <span class="s2">with </span><span class="s1">self</span><span class="s3">.</span><span class="s1">subTest</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">=</span><span class="s1">vty</span><span class="s3">):</span>
                <span class="s1">arr </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">((</span><span class="s1">vty</span><span class="s3">.</span><span class="s1">num_elements</span><span class="s3">,))</span>
                <span class="s1">kernel </span><span class="s3">= </span><span class="s1">make_kernel</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">)</span>
                <span class="s1">kernel</span><span class="s3">[</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">](</span><span class="s1">arr</span><span class="s3">)</span>
                <span class="s1">np</span><span class="s3">.</span><span class="s1">testing</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span>
                    <span class="s1">arr</span><span class="s3">, </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">(</span><span class="s1">range</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">.</span><span class="s1">num_elements</span><span class="s3">))</span>
                <span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_fancy_creation_readout</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s2">for </span><span class="s1">vty </span><span class="s2">in </span><span class="s1">vector_types</span><span class="s3">.</span><span class="s1">values</span><span class="s3">():</span>
            <span class="s2">with </span><span class="s1">self</span><span class="s3">.</span><span class="s1">subTest</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">=</span><span class="s1">vty</span><span class="s3">):</span>
                <span class="s1">kernel </span><span class="s3">= </span><span class="s1">make_fancy_creation_kernel</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">)</span>

                <span class="s1">expected </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">array</span><span class="s3">([</span>
                    <span class="s6"># 1-component vectors</span>
                    <span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">,</span>
                    <span class="s6"># 2-component vectors</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s6"># 3-component vectors</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s6"># 4-component vectors</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">4</span><span class="s3">,</span>
                    <span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">4</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">1</span><span class="s3">,</span>
                    <span class="s4">1</span><span class="s3">, </span><span class="s4">2</span><span class="s3">, </span><span class="s4">3</span><span class="s3">, </span><span class="s4">4</span>
                <span class="s3">])</span>
                <span class="s1">arr </span><span class="s3">= </span><span class="s1">np</span><span class="s3">.</span><span class="s1">zeros</span><span class="s3">(</span><span class="s1">expected</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">)</span>
                <span class="s1">kernel</span><span class="s3">[</span><span class="s4">1</span><span class="s3">, </span><span class="s4">1</span><span class="s3">](</span><span class="s1">arr</span><span class="s3">)</span>
                <span class="s1">np</span><span class="s3">.</span><span class="s1">testing</span><span class="s3">.</span><span class="s1">assert_almost_equal</span><span class="s3">(</span><span class="s1">arr</span><span class="s3">, </span><span class="s1">expected</span><span class="s3">)</span>

    <span class="s2">def </span><span class="s1">test_vector_type_alias</span><span class="s3">(</span><span class="s1">self</span><span class="s3">):</span>
        <span class="s0">&quot;&quot;&quot;Tests that `cuda.&lt;vector_type.alias&gt;` are importable and 
        that is the same as `cuda.&lt;vector_type.name&gt;`. 
 
        `test_fancy_creation_readout` only test vector types imported 
        with its name. This test makes sure that construction with 
        objects imported with alias should work the same. 
        &quot;&quot;&quot;</span>
        <span class="s2">for </span><span class="s1">vty </span><span class="s2">in </span><span class="s1">vector_types</span><span class="s3">.</span><span class="s1">values</span><span class="s3">():</span>
            <span class="s2">for </span><span class="s1">alias </span><span class="s2">in </span><span class="s1">vty</span><span class="s3">.</span><span class="s1">user_facing_object</span><span class="s3">.</span><span class="s1">aliases</span><span class="s3">:</span>
                <span class="s2">with </span><span class="s1">self</span><span class="s3">.</span><span class="s1">subTest</span><span class="s3">(</span><span class="s1">vty</span><span class="s3">=</span><span class="s1">vty</span><span class="s3">.</span><span class="s1">name</span><span class="s3">, </span><span class="s1">alias</span><span class="s3">=</span><span class="s1">alias</span><span class="s3">):</span>
                    <span class="s1">self</span><span class="s3">.</span><span class="s1">assertEqual</span><span class="s3">(</span>
                        <span class="s1">id</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s1">vty</span><span class="s3">.</span><span class="s1">name</span><span class="s3">)), </span><span class="s1">id</span><span class="s3">(</span><span class="s1">getattr</span><span class="s3">(</span><span class="s1">cuda</span><span class="s3">, </span><span class="s1">alias</span><span class="s3">))</span>
                    <span class="s3">)</span>
</pre>
</body>
</html>