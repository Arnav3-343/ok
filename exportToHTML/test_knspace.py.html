<html>
<head>
<title>test_knspace.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #bcbec4;}
.s1 { color: #cf8e6d;}
.s2 { color: #6aab73;}
.s3 { color: #bcbec4;}
.s4 { color: #2aacb8;}
.s5 { color: #7a7e85;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
test_knspace.py</font>
</center></td></tr></table>
<pre>
<span class="s1">import </span><span class="s0">unittest</span>
<span class="s2">'''ACHTUNG: when testing, never re-use widget names, otherwise the tests 
may fail as the namespace will remember the names between tests. 
'''</span>


<span class="s1">class </span><span class="s0">KNSpaceTestCase</span><span class="s3">(</span><span class="s0">unittest</span><span class="s3">.</span><span class="s0">TestCase</span><span class="s3">):</span>

    <span class="s1">def </span><span class="s0">test_not_exists</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertRaises</span><span class="s3">(</span><span class="s0">AttributeError</span><span class="s3">, </span><span class="s1">lambda</span><span class="s3">: </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_not_exists_property</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertRaises</span><span class="s3">(</span><span class="s0">AttributeError</span><span class="s3">, </span><span class="s1">lambda</span><span class="s3">: </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label2</span><span class="s3">)</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">property</span><span class="s3">(</span><span class="s2">'label2'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIsNone</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label2</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_allow_none</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span><span class="s3">, </span><span class="s0">KNSpaceBehavior</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s1">class </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">KNSpaceBehavior</span><span class="s3">, </span><span class="s0">Widget</span><span class="s3">):</span>
            <span class="s1">pass</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">label3 </span><span class="s3">= </span><span class="s4">1</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">label3 </span><span class="s3">= </span><span class="s1">None</span>
        <span class="s0">w </span><span class="s3">= </span><span class="s0">MyWidget</span><span class="s3">()</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">knspace </span><span class="s3">= </span><span class="s0">knspace</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">knspace </span><span class="s3">= </span><span class="s1">None</span>

    <span class="s1">def </span><span class="s0">test_name</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span><span class="s3">, </span><span class="s0">KNSpaceBehavior</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s1">class </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">KNSpaceBehavior</span><span class="s3">, </span><span class="s0">Widget</span><span class="s3">):</span>
            <span class="s1">pass</span>
        <span class="s0">w </span><span class="s3">= </span><span class="s0">MyWidget</span><span class="s3">()</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">knsname </span><span class="s3">= </span><span class="s2">'label4'</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">knsname </span><span class="s3">= </span><span class="s2">''</span>

    <span class="s1">def </span><span class="s0">test_proxy_ref</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Widget</span><span class="s3">()</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget1 </span><span class="s3">= </span><span class="s0">w</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIs</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">proxy_ref</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget1</span><span class="s3">)</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget1 </span><span class="s3">= </span><span class="s4">55</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIs</span><span class="s3">(</span><span class="s4">55</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget1</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_constructor</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span><span class="s3">, </span><span class="s0">KNSpaceBehavior</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s1">class </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">KNSpaceBehavior</span><span class="s3">, </span><span class="s0">Widget</span><span class="s3">):</span>
            <span class="s1">pass</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">knsname</span><span class="s3">=</span><span class="s2">'construct_name'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">construct_name</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_re_assign</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span><span class="s3">, </span><span class="s0">KNSpaceBehavior</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s1">class </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">KNSpaceBehavior</span><span class="s3">, </span><span class="s0">Widget</span><span class="s3">):</span>
            <span class="s1">pass</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">knsname</span><span class="s3">=</span><span class="s2">'construct_name2'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">construct_name2</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>
        <span class="s0">w2 </span><span class="s3">= </span><span class="s0">MyWidget</span><span class="s3">(</span><span class="s0">knsname</span><span class="s3">=</span><span class="s2">'construct_name2'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">construct_name2</span><span class="s3">, </span><span class="s0">w2</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_simple</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
NamedLabel: 
    knsname: 'label5' 
    text: 'Hello' 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label5</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIs</span><span class="s3">(</span><span class="s0">w</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label5</span><span class="s3">.</span><span class="s0">__self__</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIsNot</span><span class="s3">(</span><span class="s0">w</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label5</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Hello'</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label5</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">text </span><span class="s3">= </span><span class="s2">'Goodbye'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Goodbye'</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label5</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_simple_multiple_names</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
BoxLayout: 
    NamedLabel: 
        knsname: 'label61' 
        text: 'Hello' 
    NamedLabel: 
        knsname: 'label62' 
        text: 'Goodbye' 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Hello'</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label61</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Goodbye'</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label62</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_simple_binding</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
#:import knspace kivy.uix.behaviors.knspace.knspace 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
BoxLayout: 
    text: knspace.label7.text if knspace.label7 else '' 
    NamedLabel: 
        knsname: 'label7' 
        text: 'Hello' 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Hello'</span><span class="s3">, </span><span class="s0">w</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">label7</span><span class="s3">.</span><span class="s0">text </span><span class="s3">= </span><span class="s2">'Goodbye'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s2">'Goodbye'</span><span class="s3">, </span><span class="s0">w</span><span class="s3">.</span><span class="s0">text</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_simple_name_change</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
NamedLabel: 
    knsname: 'label8' 
    text: 'Hello' 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label8</span><span class="s3">)</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">knsname </span><span class="s3">= </span><span class="s2">'named_label8'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIsNone</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label8</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">, </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">named_label8</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_fork_string</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
BoxLayout: 
    NamedLabel: 
        knspace: 'fork' 
        knsname: 'label9' 
        text: 'Hello' 
    NamedLabel: 
        knspace: 'fork' 
        knsname: 'label9' 
        text: 'Goodbye' 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">children</span><span class="s3">[</span><span class="s4">0</span><span class="s3">].</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label9</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">children</span><span class="s3">[</span><span class="s4">1</span><span class="s3">].</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">label9</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_fork</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span><span class="s3">, </span><span class="s0">KNSpaceBehavior</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">widget </span><span class="s1">import </span><span class="s0">Widget</span>

        <span class="s1">class </span><span class="s0">NamedWidget</span><span class="s3">(</span><span class="s0">KNSpaceBehavior</span><span class="s3">, </span><span class="s0">Widget</span><span class="s3">):</span>
            <span class="s1">pass</span>
        <span class="s0">nw </span><span class="s3">= </span><span class="s0">NamedWidget</span><span class="s3">()</span>
        <span class="s0">w </span><span class="s3">= </span><span class="s0">Widget</span><span class="s3">()</span>
        <span class="s0">w2 </span><span class="s3">= </span><span class="s0">Widget</span><span class="s3">()</span>

        <span class="s0">before </span><span class="s3">= </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">fork</span><span class="s3">()</span>
        <span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget2 </span><span class="s3">= </span><span class="s0">w</span>
        <span class="s0">after </span><span class="s3">= </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">fork</span><span class="s3">()</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget2</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">before</span><span class="s3">.</span><span class="s0">widget2</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">after</span><span class="s3">.</span><span class="s0">widget2</span><span class="s3">, </span><span class="s0">w</span><span class="s3">)</span>

        <span class="s0">child </span><span class="s3">= </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">fork</span><span class="s3">()</span>
        <span class="s0">child2 </span><span class="s3">= </span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">fork</span><span class="s3">()</span>
        <span class="s0">grandchild </span><span class="s3">= </span><span class="s0">child</span><span class="s3">.</span><span class="s0">fork</span><span class="s3">()</span>
        <span class="s0">child</span><span class="s3">.</span><span class="s0">widget3 </span><span class="s3">= </span><span class="s0">w2</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">grandchild</span><span class="s3">.</span><span class="s0">widget3</span><span class="s3">, </span><span class="s0">w2</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">child</span><span class="s3">.</span><span class="s0">widget3</span><span class="s3">, </span><span class="s0">w2</span><span class="s3">)</span>
        <span class="s5"># this could actually be none rather than raising, depending</span>
        <span class="s5"># on when the class was instantiated. So if this fails, change the</span>
        <span class="s5"># test to assert is none.</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIsNone</span><span class="s3">(</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">widget3</span><span class="s3">)</span>
        <span class="s0">grandchild</span><span class="s3">.</span><span class="s0">parent </span><span class="s3">= </span><span class="s0">child2</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertIsNone</span><span class="s3">(</span><span class="s0">grandchild</span><span class="s3">.</span><span class="s0">widget3</span><span class="s3">)</span>

    <span class="s1">def </span><span class="s0">test_fork_binding</span><span class="s3">(</span><span class="s0">self</span><span class="s3">):</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">lang </span><span class="s1">import </span><span class="s0">Builder</span>
        <span class="s1">from </span><span class="s0">kivy</span><span class="s3">.</span><span class="s0">uix</span><span class="s3">.</span><span class="s0">behaviors</span><span class="s3">.</span><span class="s0">knspace </span><span class="s1">import </span><span class="s0">knspace</span>

        <span class="s0">w </span><span class="s3">= </span><span class="s0">Builder</span><span class="s3">.</span><span class="s0">load_string</span><span class="s3">(</span><span class="s2">''' 
&lt;NamedLabel@KNSpaceBehavior+Label&gt; 
 
&lt;MyComplexWidget@NamedLabel&gt;: 
    knsname: 'root_label' 
    text: 'Hello' 
    NamedLabel: 
        id: child 
        knsname: 'child_label' 
        text: self.knspace.root_label.text if self.knspace.root_label else '' 
 
BoxLayout: 
    MyComplexWidget: 
        knspace: 'fork' 
        id: first 
    MyComplexWidget: 
        knspace: 'fork' 
        id: second 
'''</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>

        <span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">text </span><span class="s3">= </span><span class="s2">'Goodbye'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>

        <span class="s0">first </span><span class="s3">= </span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace </span><span class="s3">= </span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span>
        <span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace </span><span class="s3">= </span><span class="s0">first</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>

        <span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">text </span><span class="s3">= </span><span class="s2">'Goodbye2'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye2'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye2'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>

        <span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">root_label</span><span class="s3">.</span><span class="s0">text </span><span class="s3">= </span><span class="s2">'Goodbye3'</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye3'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">child</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">first</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Goodbye3'</span><span class="s3">)</span>
        <span class="s0">self</span><span class="s3">.</span><span class="s0">assertEqual</span><span class="s3">(</span><span class="s0">w</span><span class="s3">.</span><span class="s0">ids</span><span class="s3">.</span><span class="s0">second</span><span class="s3">.</span><span class="s0">knspace</span><span class="s3">.</span><span class="s0">child_label</span><span class="s3">.</span><span class="s0">text</span><span class="s3">, </span><span class="s2">'Hello'</span><span class="s3">)</span>
</pre>
</body>
</html>